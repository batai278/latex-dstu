\section{Моделювання результатів виконання тестових завдань}

\subsection{Процес Пуассона}
Щоб моделювати темп виконання студентами контрольних задач, використаємо
відомі дані з психології щодо ритму виконання теппінг-тесту для людей
з різними типами вищої нервової діяльності.
Оскільки постукування є потоком однорідних випадкових подій, змоделюємо їх
як реалізації процесу Пуассона.

Нехай $\left\{ N\left( t \right) \vert t \ge 0 \right\}$ --- процес Пуассона з
інтенсивністю $\lambda\left( t \right)$.
Маємо $7$ контрольних точок на часовій вісі $t_0 = 0, t_1 = 5, \dots, t_6 = 30$.
Введемо відрізок часу $T$, за який проводиться вимірювання,
та проміжки $T_i$, на які його розбито в експерименті
\begin{equation*}
  T = \left( 0, 30 \right], \qquad
  T_i = \left( t_{i-1}, t_i \right], \qquad
  i = \overline{1, 6}.
\end{equation*}
Нехай $\nu_i$ визначається наступним чином
\begin{equation*}
  \nu_i = N\left( t_i \right) - N\left( t_{i-1} \right),
  \qquad i = \overline{1,6},
\end{equation*}
тоді $\nu_i$ --- випадкова величина, що має розподіл Пуассона з параметром
$\lambda_i$, де \cite{Bulinsky:2003}
\begin{equation*}
  \lambda_i
  = m\left( T_i \right)
  = \int\limits_{t_{i-1}}^{t_i} \lambda\left( \tau \right) \; d\tau, \qquad
  i = \overline{1, 6}.
\end{equation*}
Функція $m$ --- міра інтенсивності. \cite{Kingman:1992}

Проміжки $T_i$ утворюють розбиття множини $T$, а отже не перетинаються.
Це означає, що випадкові величини $\nu_i$ незалежні між собою,
і є можливість згенерувати процес натискання за допомогою $6$ незалежних
випадкових величин, що мають розподіл Пуассона.

Інтенсивність (параметр $\lambda$) є математичним очікуванням випадкової
величини, що має розподіл Пуассона.
Маючи результати реальних експериментів, можна обчислити середні значення
кількості постукувань для кожного часового проміжку $T_i$, а отримані
результати використовувати в якості параметрів $\lambda_i$.

Візьмемо значення відомого експерименту з підручника \cite{Ilin:2001}, які
зображено на рис. \ref{fig:tapping:Ilin01}.
Оскільки результат один, то його значення будуть середніми з вибірки, що
складається з одного вектора --- їх і використаємо в якості параметрів
$\lambda_i$.
На рис. \ref{fig:tapping:poisson} зображено різні реалізації послідовності
випадкових величин, що розподілені за законом Пуассона з параметрами
\begin{equation}\label{eq:tapping:poisson}
  \left[ \lambda_{1}, \lambda_{2}, \lambda_{3}, \lambda_{4}, \lambda_{5},
         \lambda_{6} \right]
  = \left[ 43, 40, 38, 37, 38, 35 \right].
\end{equation}

\begin{figure}[h]
  \centering
    \begin{tikzpicture}[scale=1]
      \begin{axis}[ymin=20, ymax=50, xmin=5, xmax=30, ytick=\empty,
        xmajorgrids={true},
        ylabel={Кількість точок}, ylabel near ticks,
        xlabel={час, с}]

        \draw[dashed,color=gray!50] ({rel axis cs:0,43}|-{axis cs:0,43})
                                 -- ({rel axis cs:1,43}|-{axis cs:0,43});
        \addplot table [x, y, col sep=comma] {data/chartIlinExample01.csv};
      \end{axis}
    \end{tikzpicture}
  \caption{Спадна ламана, побудована на основі даних з \cite{Ilin:2001}}
  \label{fig:tapping:Ilin01}
\end{figure}


\subsection{Квадратична апроксимація методом найменших квадратів}

Види результуючих ламаних (опукла, ввігнута, рівна, спадна) можна представити
квадратичними функціями виду
\begin{equation*}
  y\left( t \right) = a \cdot t^2 + b \cdot t + c.
\end{equation*}

На рис. \ref{fig:tapping:poisson:sqr} зображено реалізації послідовності
випадкових величин, що розподілені за законом Пуассона, та криві, що є
результатом апроксимації цих реалізацій.

\begin{figure}[h]
  \centering
  \begin{subfigure}[b]{0.45\textwidth}
    %\includegraphics[width=.75\textwidth]{code/least_squares_approximation}
    \includegraphics[width=\textwidth]{images/poisson}
    \caption{Без апроксимації}
    \label{fig:tapping:poisson}
  \end{subfigure}
  \begin{subfigure}[b]{0.45\textwidth}
    %\includegraphics[width=.75\textwidth]{code/least_squares_approximation}
    \includegraphics[width=\textwidth]{images/poisson_approximation}
    \caption{З апроксимацією}
    \label{fig:tapping:poisson:sqr}
  \end{subfigure}
  \caption{Приклади результатів моделювання}
\end{figure}

Щоб представити результати у вигляді квадратичних функцій, використаємо
метод найменших квадратів.
Нехай $\left\{ y_i \mid i=\overline{1, 6} \right\}$ --- результати поточного
теппінг-тесту.
Суть методу полягає в знаходженні таких коефіцієнтів $a$, $b$ і $c$, з якими
наступна величина приймає мінімальне значення
\begin{equation*}
  R^2\left( a, b, c \right)
  = \sum_{i=1}^{6} \left( a \cdot t_i^2 + b \cdot t_i + c - y_i \right)^2.
\end{equation*}
Для цього треба взяти часткові похідні по кожному коефіцієнту, прирівняти ці
похідні до нуля та розв’язати отриману систему
\begin{equation*}
  \begin{cases}
    \sum_{i=1}^{6} 2 \cdot \left( a \cdot t_i^2 + b \cdot t_i + c - y_i \right)
    &= 0 \\
    \sum_{i=1}^{6} 2 \cdot t_i
      \cdot \left( a \cdot t_i^2 + b \cdot t_i + c - y_i \right)
    &= 0 \\
    \sum_{i=1}^{6} 2 \cdot t_i^2
      \cdot \left( a \cdot t_i^2 + b \cdot t_i + c - y_i \right)
    &= 0.
  \end{cases}
\end{equation*}
Цю систему можна переписати в матричному вигляді наступним чином
\begin{equation*}
  \begin{bmatrix}
    \sum_{i=1}^{6} t_i^2 & \sum_{i=1}^{6} t_i   & \sum_{i=1}^{6} 1 \\
    \sum_{i=1}^{6} t_i^3 & \sum_{i=1}^{6} t_i^2 & \sum_{i=1}^{6} t_i \\
    \sum_{i=1}^{6} t_i^4 & \sum_{i=1}^{6} t_i^3 & \sum_{i=1}^{6} t_i^2
  \end{bmatrix}
  \cdot
  \begin{bmatrix}
    a \\
    b \\
    c
  \end{bmatrix}
  =
  \begin{bmatrix}
    \sum_{i=1}^{6} y_i \\
    \sum_{i=1}^{6} y_i \cdot t_i \\
    \sum_{i=1}^{6} y_i \cdot t_i^2
  \end{bmatrix}.
\end{equation*}
Введемо позначення:
\begin{equation*}
  \begin{split}
    &\sum_{i=1}^{6} 1 = N, \\
    &\sum_{i=1}^{6} t_i^k = X^k,\qquad k=\overline{1, 4}, \\
    &\sum_{i=1}^{6} y_i \cdot t_i^k = YX^k,\qquad k=\overline{0, 2}.
  \end{split}
\end{equation*}
Рівняння прийняло наступний вигляд
\begin{equation*}
  \begin{bmatrix}
    X^2 & X   & N \\
    X^3 & X^2 & X \\
    X^4 & X^3 & X^2
  \end{bmatrix}
  \cdot
  \begin{bmatrix}
    a \\
    b \\
    c
  \end{bmatrix}
  =
  \begin{bmatrix}
    Y \\
    YX \\
    YX^2
  \end{bmatrix}.
\end{equation*}
Використаємо метод Крамера для розв’язання системи лінійних рівнянь.
Визначник $\Delta$
\begin{equation*}
  \begin{split}
    \Delta
    = X^2 \cdot \left( X^2 \cdot X^2 - X  \cdot X^3 \right)
       &- X \cdot \left( X^3 \cdot X^2 - X  \cdot X^4 \right) \\
       &+ N \cdot \left( X^3 \cdot X^3 - X^2 \cdot X^4 \right).
  \end{split}
\end{equation*}
Визначник $\Delta_a$
\begin{equation*}
  \begin{split}
    \Delta_a
    =     Y   \cdot \left( X^2 \cdot X^2 - X \cdot X^3 \right)
      &- YX   \cdot \left( X   \cdot X^2 - N \cdot X^3 \right) \\
      &+ YX^2 \cdot \left( X   \cdot X   - N \cdot X^2 \right).
  \end{split}
\end{equation*}
Визначник $\Delta_b$
\begin{equation*}
  \begin{split}
    \Delta_b
    =  -  Y   \cdot \left( X^3 \cdot X^2 - X \cdot X^4 \right)
      &+ YX   \cdot \left( X^2 \cdot X^2 - N \cdot X^4 \right) \\
      &- YX^2 \cdot \left( X^2 \cdot X   - N \cdot X^3 \right).
  \end{split}
\end{equation*}
Визначник $\Delta_c$
\begin{equation*}
  \begin{split}
    \Delta_c
    =     Y   \cdot \left( X^3 \cdot X^3 - X^2 \cdot X^4 \right)
      &- YX   \cdot \left( X^2 \cdot X^3 - X   \cdot X^4 \right) \\
      &+ YX^2 \cdot \left( X^2 \cdot X^2 - X   \cdot X^3 \right).
  \end{split}
\end{equation*}
Відомо, що розв’язками є наступні вирази
\begin{equation*}
  a = \frac{\Delta_a}{\Delta},\qquad
  b = \frac{\Delta_b}{\Delta},\qquad
  c = \frac{\Delta_c}{\Delta}.
\end{equation*}
Бачимо, що параметри --- лінійні комбінації $y_i$, а коефіцієнти при $y_i$ ---
раціональні дроби.
Тобто можна записати розв’язки наступним чином
\begin{equation*}
  a = \sum_{i=1}^{6} y_i \cdot \frac{a_i}{\Delta},\qquad
  b = \sum_{i=1}^{6} y_i \cdot \frac{b_i}{\Delta},\qquad
  c = \sum_{i=1}^{6} y_i \cdot \frac{c_i}{\Delta}.
\end{equation*}

\subsection{Аналіз квадратичної апроксимації}

\subsubsection{Задача}
Запишемо умови, що накладаються на $a$, $b$ і $c$, за яких парабола
\begin{equation*}
  y\left( t \right) = a \cdot t^2 + b \cdot t + c
\end{equation*}
відповідає раніше визначеним типам вищої нервової діяльності.
Введемо такі позначення: $t_{max}$ і $t_{min}$ --- точки, в яких парабола
досягає локального максимуму та мінімуму на відрізку $\left[ t_1, t_6 \right]$
відповідно ($t_1$ і $t_6$ є точками першого та останнього спостереження).
Оскільки маємо справу з випадковими величинами, потрібно ввести похибку
$\varepsilon$, яка вважається допустимою.
Для теппінг-тесту зазвичай беруть $\varepsilon = 2$. \cite{Ilin:2001}

Глобального екстремуму функція $y$ досягає в точці
\begin{equation*}
  t_g = - \frac{b}{2 \cdot a}.
\end{equation*}

\subsubsection{Змішаний тип}
Крива, що відповідає змішаному типу, весь час тримається приблизно на
початковому рівні
\begin{equation*}
  \begin{cases}
    y\left( t_{max} \right) - y\left( t_1 \right) \le \varepsilon, \\
    y\left( t_1 \right) - y\left( t_{min} \right) \le \varepsilon.
  \end{cases}
\end{equation*}

Для першої нерівності можливі три випадки:
\begin{enumerate}
  \item
    якщо локальний максимум знаходиться в точці $t_1$, нерівність приймає вид
    $0 \le \varepsilon$, що виконується завжди;
  \item
    якщо локальний максимум знаходиться в точці $t_6$, на $b$ накладається
    обмеження
    \begin{equation*}
      b \le \frac{\varepsilon}{t_6 - t_1} - a \cdot \left( t_6 + t_1 \right);
    \end{equation*}
  \item
    коли глобальний максимум досягається на проміжку $\left( t_1; t_6 \right)$
    \begin{equation*}
      \begin{cases}
        t_1 < - \frac{b}{2 \cdot a} < t_6 \\
        a < 0
      \end{cases} \Rightarrow
      t_{max} = - \frac{b}{2 \cdot a},
    \end{equation*}
    обмеження приймає більш складний вид
    \begin{equation*}
      - \frac{3 \cdot b^2}{4 \cdot a} - b \cdot t_1 - a \cdot t_1^2
      \le \varepsilon
    \end{equation*}
\end{enumerate}

Для другої нерівності можливі ті ж самі випадки, але обмеження дещо інші
\begin{enumerate}
  \item
    якщо локальний мінімум знаходиться в точці $t_1$, нерівність приймає вид
    $0 \le \varepsilon$, що виконується завжди;
  \item
    якщо локальний мінімум знаходиться в точці $t_6$, на $b$ накладається
    обмеження
    \begin{equation*}
      b \ge \frac{\varepsilon}{t_1 - t_6} - a \cdot \left( t_1 + t_6 \right);
    \end{equation*}
  \item
    коли глобальний мінімум досягається на проміжку $\left( t_1; t_6 \right)$
    \begin{equation*}
      \begin{cases}
        t_1 < - \frac{b}{2 \cdot a} < t_6 \\
        a < 0
      \end{cases} \Rightarrow
      t_{max} = - \frac{b}{2 \cdot a},
    \end{equation*}
    обмеження приймає вид
    \begin{equation*}
      \frac{3 \cdot b^2}{4 \cdot a} + b \cdot t_1 + a \cdot t_1^2
      \le \varepsilon
    \end{equation*}
\end{enumerate}

Запишемо обмеження, що накладаються на $a$ і $b$, у вигляді таблиці
\begin{table}[h]
  \caption{Обмеження для змішаного типу}
  \centering
  \begin{tabular}{|*{4}{c|}}
    \hline
    \backslashbox{$t_{min}$}{$t_{max}$} & $t_1$ & $t_6$ & $-\frac{b}{2 \cdot a}$\\
    \hline
    $t_1$ & $\left( a, b \right) \in \mathbb{R}^2$ & & $ - \frac{3 \cdot b^2}{4 \cdot a} - b \cdot t_1 - a \cdot t_1^2 \le \varepsilon $\\
    \hline
    $t_6$ & & $\left( a, b \right) \in \mathbb{R}^2$ & \\
    \hline
    $-\frac{b}{2 \cdot a}$ & $\frac{3 \cdot b^2}{4 \cdot a} + b \cdot t_1 + a \cdot t_1^2
      \le \varepsilon$ & & $\left( a, b \right) \in \emptyset$ \\
    \hline
  \end{tabular}
  \label{tab:tab}
\end{table}

%\begin{longtable}{|r|l|}
%\caption{A long table\label{long}}\\
%\hline
%\multicolumn{2}{|c|}%
%{This part appears at the top of the table}\\
%\hline
%\textsc{First}&\textsc{Second}\\
%\endfirsthead
%\caption[lol]{(продовження)}\\
%\hline
%\multicolumn{2}{|c|}%
%{This part appears at the top of every other page}\\
%\textbf{First}&\textbf{Second}\\
%%\hline
%\endhead
%%\hline
%%This goes at the&bottom.\\
%%\hline
%\endfoot
%%\hline
%%These lines will&appear\\
%%in place of the & usual foot\\
%%at the end& of the table\\
%%\hline
%\endlastfoot
%\hline
%Hey & Yo \\
%\hline
%My & name \\
%\hline
%is & a \\
%\hline
%regular & long \\
%\hline
%table& ! \\
%\hline
%%\env{longtable} columns are specified& in the \\
%%same way as in the \env{tabular}& environment.\\
%%...
%%\multicolumn{2}{||c||}{This is a ...}\\
%%...
%%Some lines may take...&
%%\raggedleft This last column is a ‘‘p’’ column...
%%\tabularnewline
%%...
%%Lots of lines& like this.\\
%%...
%%\hline
%%Lots\footnote{...} of lines& like this.\\
%%Lots of lines& like this\footnote{...}\\
%%\hline
%%Lots of lines& like this.\\
%%...
%\end{longtable}

\subsubsection{Слабкий тип}
Крива, що відповідає слабкому типу, спадає після моменту $t_1$
і не повертається до початкового положення
\begin{equation*}
  \begin{cases}
    t_{max} = t_1, \\
    y\left( t_{max} \right) - y\left( t_{min} \right) > \varepsilon.
  \end{cases}
\end{equation*}

\subsubsection{Неврівноважений тип}
Крива, що відповідає неврівноваженому типу, спочатку зростає,
потім не пізніше моменту часу $t_3$ починає спадати нижче початкового рівня
\begin{equation*}
  \begin{cases}
    t_2 \le t_{max} \le t_3 < t_{min}, \\
    y\left( t_{max} \right) - y\left( t_1\right) > \varepsilon, \\
    y\left( t_1 \right) - y\left( t_{min} \right) > \varepsilon.
  \end{cases}
\end{equation*}

\subsubsection{Рухливий тип}
Крива, що відповідає рухливому типу, спочатку зростає,
не пізніше моменту $t_3$ починає спадати,
а до моменту $t_6$ повертається до початкового рівня або спадає нижче нього
\begin{equation*}
  \begin{cases}
    t_3 \le t_{max}, \\
    y\left( t_{max} \right) - y\left( t_1\right) > \varepsilon, \\
    y\left( t_6 \right) \le y\left( t_1 \right).
  \end{cases}
\end{equation*}

\subsubsection{Інертний тип}
Крива, що відповідає інертному типу, спочатку спадає,
а під кінець тесту може зрости до початкового рівня
\begin{equation*}
  \begin{cases}
    t_{min} > t_1 \\
    y\left( t_{max} \right) - y\left( t_1 \right) > \varepsilon.
  \end{cases}
\end{equation*}

\subsubsection{Результати класифікації}
Було згенеровано $6$ вибірок по $100$ реалізацій процесу Пуассона з
інтенсивністю, яку було вказано у формулі \eqref{eq:tapping:poisson}.
Ці реалізації відповідають проходженню теппінг-тесту шістьма групами по сто
студентів.
Результати класифікації можна побачити на рис. \ref{fig:tapping:poisson:types}.

Опис:
\begin{itemize}
  \item
    Найбільш розповсюджений тип --- слабкий, що зустрівся у $60\%$
    випадків;
  \item
    $11\%$ студентів відносяться до неврівноваженого типу;
  \item
    $7\%$ --- студенти рухливого типу;
  \item
    Студенти інертного типу зустрілися майже у $13\%$ випадків;
  \item
    $2\%$ --- студенти зі змішаним типом вищої нервової діяльності;
  \item
    Не вдалося віднести до того чи іншого типу близько $7\%$ студентів.
\end{itemize}

\begin{figure}[h]
  \centering
  \includegraphics[width=\textwidth]{images/poisson_types}
  \caption{Результати моделювання}
  \label{fig:tapping:poisson:types}
\end{figure}
